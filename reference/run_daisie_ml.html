<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Run DAISIE analysis"><title>Run DAISIE analysis — run_daisie_ml • DAISIEutils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run DAISIE analysis — run_daisie_ml"><meta property="og:description" content="Run DAISIE analysis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DAISIEutils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tece-lab/DAISIEutils/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Run DAISIE analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/tece-lab/DAISIEutils/blob/HEAD/R/run_daisie_ml.R" class="external-link"><code>R/run_daisie_ml.R</code></a></small>
      <div class="d-none name"><code>run_daisie_ml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run DAISIE analysis</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_daisie_ml</span><span class="op">(</span></span>
<span>  <span class="va">daisie_data</span>,</span>
<span>  <span class="va">data_name</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">array_index</span>,</span>
<span>  <span class="va">cond</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"lsodes"</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"subplex"</span>,</span>
<span>  results_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  low_rates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rep_index <span class="op">=</span> <span class="st">"NULL"</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  par_upper_bound <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  test <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>daisie_data</dt>
<dd><p>A list, conforming to the <code>DAISIE</code> object format.
Usually preprocessed by <code><a href="https://rdrr.io/pkg/DAISIE/man/DAISIE_dataprep.html" class="external-link">DAISIE::DAISIE_dataprep()</a></code>, see it's documentation
for details. Otherwise it may be generated via simulations, using
<code><a href="https://rdrr.io/pkg/DAISIE/man/DAISIE_sim.html" class="external-link">DAISIE::DAISIE_sim_cr()</a></code> and friends.</p></dd>


<dt>data_name</dt>
<dd><p>String. Will be used for the name of the created output
folder.</p></dd>


<dt>model</dt>
<dd><p>A string with model that should run. Models are as follows:</p><ul><li><p><code>"cr_dd"</code> Clade specific model - diversity dependent. All parameters
free.</p></li>
<li><p><code>"cr_di"</code> Clade specific model - diversity independent (K = Inf). All
other parameters free.</p></li>
<li><p><code>"cr_dd_0laa"</code> Clade specific model - diversity dependent and no
anagenesis (laa fixed to zero). All other parameters free.</p></li>
<li><p><code>"cr_di_0laa"</code> Clade specific model - diversity independent (K = Inf)
and no anagenesis (laa fixed to zero). All other parameters free.</p></li>
<li><p><code>"cr_di_0lac"</code> Clade specific model - diversity indendent (K = Inf)
and no cladogenesis (lac fixed to zero). All other parameters free.</p></li>
<li><p><code>"cr_dd_0lac"</code> Clade specific model - diversity dependent and no
cladogenesis (lac fixed to zero). All other parameters free.</p></li>
<li><p><code>"rr_lac_di"</code> Clade specific model - diversity independent (K = Inf)
and relaxed cladogenesis. All other parameters free.</p></li>
<li><p><code>"rr_lac_dd"</code> Clade specific model - diversity dependent and relaxed
cladogenesis. All other parameters free.</p></li>
<li><p><code>"rr_mu_di"</code> Clade specific model - diversity independent (K = Inf) and
relaxed extinction. All other parameters free.</p></li>
<li><p><code>"rr_mu_dd"</code> Clade specific model - diversity dependent and relaxed
extinction. All other parameters free.</p></li>
<li><p><code>"rr_k"</code> Clade specific model - diversity dependent and relaxed carrying
capacity. All other parameters free.</p></li>
<li><p><code>"rr_gam_di"</code> Clade specific model - diversity independent (K = Inf)
and relaxed colonisation. All other parameters free.</p></li>
<li><p><code>"rr_gam_dd"</code> Clade specific model - diversity dependent and relaxed
colonisation. All other parameters free.</p></li>
<li><p><code>"rr_laa_di"</code> Clade specific model - diversity independent (K = Inf)
and relaxed anagenesis. All other parameters free.</p></li>
<li><p><code>"rr_laa_dd"</code> Clade specific model - diversity dependent and relaxed
anagenesis. All other parameters free.</p></li>
<li><p><code>"rr_mu_di_0lac"</code> Clade specific model - diversity independent,
relaxed extinction, and no cladogenesis (lac fixed to zero). All other
parameters free.</p></li>
<li><p><code>"rr_mu_dd_0lac"</code> Clade specific model - diversity dependent, relaxed
extinction, and no cladogenesis (lac fixed to zero). All other
parameters free.</p></li>
<li><p><code>"rr_k_0lac"</code> Clade specific model - diversity dependent, relaxed
carrying capacity, and no cladogenesis (lac fixed to zero). All other
parameters free.</p></li>
<li><p><code>"rr_gam_di_0lac"</code> Clade specific model - diversity independent,
relaxed colonisation, and no cladogenesis (lac fixed to zero). All other
parameters free.</p></li>
<li><p><code>"r_gam_dd_0lac"</code> Clade specific model - diversity dependent, relaxed
colonisation, and no cladogenesis (lac fixed to zero). All other
parameters free.</p></li>
<li><p><code>"rr_laa_di_0lac"</code> Clade specific model - diversity independent,
relaxed anagenesis, and no cladogenesis (lac fixed to zero). All other
parameters free.</p></li>
<li><p><code>"r_laa_dd_0lac"</code> Clade specific model - diversity dependent, relaxed
anagenesis, and no cladogenesis (lac fixed to zero). All other
parameters free.</p></li>
<li><p><code>"rr_lac_di_0laa"</code> Clade specific model - diversity independent,
relaxed cladogenesis, and no anagenesis (laa fixed to zero)</p></li>
<li><p><code>"rr_lac_dd_0laa"</code> Clade specific model - diversity dependent</p></li>
<li><p><code>"rr_mu_di_0laa"</code> Clade specific model - diversity independent</p></li>
<li><p><code>"rr_mu_dd_0laa"</code> Clade specific model - diversity dependent</p></li>
<li><p><code>"rr_k_0laa"</code> Clade specific model - diversity dependent</p></li>
<li><p><code>"rr_gam_di_0laa"</code> Clade specific model - diversity independent, relaxed
colonisation, and no anagenesis (laa fixed to zero). All other parameters
free</p></li>
<li><p><code>"rr_gam_dd_0laa"</code> Clade specific model - diversity dependent, relaxed
colonisation, and no anagenesis (laa fixed to zero). All other parameters
free</p></li>
</ul></dd>


<dt>array_index</dt>
<dd><p>A single numeric with the array index. It is used for
naming the output file.</p></dd>


<dt>cond</dt>
<dd><p>An integer specifying conditioning, as described in
<code><a href="https://rdrr.io/pkg/DAISIE/man/DAISIE_ML.html" class="external-link">DAISIE::DAISIE_ML_CS()</a></code>.</p></dd>


<dt>methode</dt>
<dd><p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code>\link{deSolve}{ode}()</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code>\link{DAISIE_ML_CS}()</code>
and <code>"ode45"</code> from <code>\link[deSolve]{ode}()</code> for
<code>\link{DAISIE_ML_IW}()</code>.</p></dd>


<dt>optimmethod</dt>
<dd><p>Method used in likelihood optimization. Default is
<code>subplex</code> (see <code>\link[subplex]{subplex}()</code> for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p></dd>


<dt>results_dir</dt>
<dd><p>A string with the path to the directory where results
are to be stored or can be found. For example, if the data in question
is (to be) stored in <code>folder_with_res/$data_name</code>, then <code>results_dir</code>
should be <code>"folder_with_res"</code>.
Defaults to <code>NULL</code>, which indicates the default directories are to be used.
Default directories are:
* <code>$HOME/results/$data_name</code> if on the cluster
* <code>getwd()/results/$data_name</code> if called from another environment
If <code>is.na(results_dir)</code>, then the object is returned to the R session and
not saved to file.</p></dd>


<dt>low_rates</dt>
<dd><p>Boolean determining whether the random sampling of initial
parameter estimates should be sampled from a broad range (FALSE) or from a
restricted range where the initial rates a ensured to be smaller (TRUE).
The latter helps when using large datasets that may fail the initial
likelihood computation with higher rates that could be sampled from the
broad range of rates.</p></dd>


<dt>rep_index</dt>
<dd><p>A string which by default is "NULL" (it is a string and not
a true NULL due to being passed from the command line), or can be a string
of a numeric which is used to detect whether multiple data set from the
same data source is being run. This is the case, for example, when fitting
a DAISIE model to a posterior distribution of data.</p></dd>


<dt>res</dt>
<dd><p>A numeric determining the resolution of the likelihood
calculations, it sets the limit for the maximum number of species for
which a probability must be computed, which must be larger than the size
of the largest clade.</p></dd>


<dt>par_upper_bound</dt>
<dd><p>A numeric defining the upper limit of the integration
of a parameter when fitting the relaxed-rate DAISIE model. If the DAISIE
model being applied is not the relaxed-rate model, this parameter can be
ignored and left as its default as it does not influence the model.</p></dd>


<dt>test</dt>
<dd><p>A boolean, defaults to <code>FALSE</code>. Set to <code>TRUE</code> for testing
purposes, to fix the seed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Nothing. Writes <code>DAISIE</code> analysis results to a <code>.rds</code> file. This
file is stored in <code>file_path</code>. The directory in of <code>file_path</code> is created
if it doesn't exist.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pedro Santos Neves, Joshua W. Lambert, Luis Valente</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datalist</span>, package <span class="op">=</span> <span class="st">"DAISIE"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">run_daisie_ml</span><span class="op">(</span></span></span>
<span class="r-in"><span>  daisie_data <span class="op">=</span> <span class="va">Galapagos_datalist</span>,</span></span>
<span class="r-in"><span>  data_name <span class="op">=</span> <span class="st">"Galapagos_datalist"</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"cr_dd"</span>,</span></span>
<span class="r-in"><span>  array_index <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  cond <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pedro Santos Neves, Joshua W. Lambert, Luis Valente, Richèl J.C. Bilderbeek, Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

